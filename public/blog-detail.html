<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Detay - Vetaris</title>
    <link rel="stylesheet" href="style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .blog-content {
            font-family: 'Inter', sans-serif;
            line-height: 1.8;
            font-size: 1.1rem;
            color: #333;
        }

        .blog-content p {
            margin-bottom: 1.5rem;
        }

        .blog-content img {
            max-width: 100%;
            border-radius: 8px;
            margin: 2rem 0;
        }

        .blog-header-img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo">Vetaris <span>.</span></div>
            <div class="hamburger-menu">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="nav-links">
                <a href="index.html">Ana Sayfa</a>
                <a href="index.html#products">Ürünler</a>
                <a href="blog.html" class="active">Blog</a>
                <a href="about.html">Hakkımızda</a>
                <a href="contact.html">İletişim</a>
            </div>
            <div class="cart-icon" onclick="toggleCart()">
                <i class="fas fa-shopping-bag fa-lg"></i>
                <span class="cart-count">0</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container" style="margin-top: 2rem; margin-bottom: 5rem; max-width: 800px;">
        <div id="post-container">
            <p>Yükleniyor...</p>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2026 Vetaris - Tüm Hakları Saklıdır.</p>
            </div>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div id="cart-modal" class="cart-modal">
        <div class="cart-header">
            <h3>Sepetim</h3>
            <span class="close-cart" onclick="toggleCart()">&times;</span>
        </div>
        <div class="cart-items"></div>
        <div class="cart-footer">
            <div class="total-price">Toplam: 0.00 ₺</div>
            <button class="btn-checkout" onclick="checkout()">Siparişi Tamamla</button>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const container = document.getElementById('post-container');
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');

            if (!id) {
                container.innerHTML = '<p>Yazı bulunamadı.</p>';
                return;
            }

            try {
                const res = await fetch(`/api/posts/${id}`);
                if (!res.ok) throw new Error('Yazı bulunamadı');

                const post = await res.json();
                const date = new Date(post.created_at).toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' });

                document.title = `${post.title} - Vetaris Blog`;

                // Simple nl2br for content if it's plain text
                const contentHtml = post.content.replace(/\n/g, '<br>');

                container.innerHTML = `
                    <h1 style="font-family: 'Playfair Display', serif; font-size: 3rem; color: var(--primary-color); margin-bottom: 0.5rem; line-height: 1.2;">
                        ${post.title}
                    </h1>
                    <div style="color: #666; margin-bottom: 2rem; font-size: 0.9rem;">
                        <i class="far fa-calendar-alt"></i> ${date}
                    </div>
                    
                    ${post.image ? `<img src="${post.image}" class="blog-header-img" alt="${post.title}">` : ''}
                    
                    <div class="blog-content">
                        ${contentHtml}
                    </div>
                    
                    <div style="margin-top: 4rem; text-align: center;">
                        <a href="blog.html" class="btn-primary" style="background-color: #eee; color: #333;">← Blog'a Dön</a>
                    </div>
                `;

            } catch (e) {
                console.error(e);
                container.innerHTML = '<p>Yazı yüklenirken hata oluştu veya yazı bulunamadı.</p>';
            }
        });
    </script>
</body>

</html>